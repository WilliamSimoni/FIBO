# FiBo (Filtering Border)
FiBo is the backend I developed for my thesis "Design and development of a framework for the generation of multimodal interfaces in Industry 4.0 contexts "

# General architecture

The project goal was to provide a simple way for an IoT technician to create multimodal interfaces that could show IoT data. In order to reach this goal, we designed the architecture in four main parts:
- The project core is the configuration file, which describes what the interfaces should show or tell their users. The IoT technician can create the configuration file either by hand or by an assistance tool.
- The generators read the configuration file and then generate the respective interface. We created a GUI (Graphical User Interface) generator and an NLUI (Natural Language User Interface) generator for the project. 
- IoT devices must send their data to a data management service developed by Zerynth called ZDM (Zerynth Device Manager). In the ZDM, there is the concept of workspace, which represents an entire project. In turn, inside a workspace, several fleets group together IoT devices, usually according to geographic affiliation. All these devices are associated with various tags by function or position. Finally, the payload sent by a device to the ZDM can contain several data, each of one associated with a keyword called value. 
- Generated interfaces get IoT data, talking with a microservice called FiBo (Filtering Border), and not communicating directly with the ZDM. Since IoT devices generate a massive amount of data, another FiBo task is to aggregate this data and save the aggregation results inside an internal database.

# Configuration file

The configuration file structure focuses on the information content that the generated interfaces must convey to their users, leaving out all the other interface details like how to arrange charts in the GUI or the questions the NLUI must recognize. 
Within the file, the IoT technician must initially define project-metadata as the project name, the ZDM workspace id associated with the project, or the graphical template which the GUI generator will use to build the interface.  
Then, there is the most crucial section which concerns data. The structural element of this part is the view that represents a data container. Each view has a unique name, a list of ZDM fleet ids whose devices will generate the data contained in the view, a list of the data included in the view, and at last, a list of the alarms associated with the view.
All the elements of the data list describe one or more time series and have the following properties:
- The title is the name associated with the data.
- Time-series is a list of pairs (tag-value, aggregation), each expressing a time series. In tag-value, the user defines the time series sources in terms of tag and value. In aggregation, the user specifies the aggregation function name to aggregate the time series sources, if there are more than one. 
- Aggregation-function is the name of the default aggregation function to aggregate data temporally based on two additional fields: time range and granularity.
- The time range indicates the period, starting from now, from which to get data. The granularity indicates the length of periods in which to divide the time range.  
- The chart field contains some information that the GUI generator will use to build the interface.
For every time series source, the user can define a maximum acceptable and a minimum acceptable defining an alarm in the alarm list of a view.

Finally, the IoT technician must define the interface users. Each user can be a Viewer or an Admin:
A Viewer can access only to data generated by devices included in specific ZDM fleets. The list of these fleets is one of the user properties. 
An Admin can access to every project data. 

# FiBo architecture

As mentioned above, FiBo must authenticate users or send data to authenticated interface clients. To do that, the IoT technician must configure the system using a simple CLI made with NodeJS.
The system consists of seven components which interact via HTTP:
- The stub represents the entrance gate to most FiBo functionality: login, logout, data fetching, and system configuration. Both the interface client and the configuration CLI use HTTP to communicate with this component.
- The calculator aggregate IoT data.
- The alarm finder sets off alarms if a value sent by an IoT device is out of the bounds defined in the configuration file.
- The alarm sender warns the users of new alarms. Interface clients communicate with this component using SOCKET.IO.
These first modules were developed using NodeJS, which, due to its simplicity, allowed very rapid development. 
- The time-series database contains time-series data. The technology used for this component is InfluxDB, an open-source time-series database developed by InfluxData. 
- The project database contains project information, such as the project name and the user's credentials. This component was developed using a relational database management system called Postgres. 
- The alarm sender and the alarm finder communicate using a publish-subscribe protocol implemented by the PUBSUB component based on the Redis technology. When the alarm finder sets off an alarm, warns all the alarm senders. In turn, each alarm sender informs the connected clients who can access the abnormal data.


![alt text](https://github.com/WilliamSimoni/FiBo/blob/main/images/architecture.png?raw=true)
